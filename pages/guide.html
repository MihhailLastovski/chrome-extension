<!DOCTYPE html>
<html data-theme="light">

<head>
    <title>Highlight Text Extension</title>
    <meta charset="UTF-8">
    <link id="styleLink" rel="stylesheet" type="text/css" href="../style/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="../script/header.js"></script>
    <script src="../script/styleScript.js"></script>
    <script src="../script/guide.js"></script>
</head>

<body>  
    <h2>Гайд как использовать Apps Script</h2> 
    <p>1. Google таблицы >>> Расширения >>> Apps Script</p>
    <img src="../images/guide/step1.png">
    <p>2. Вставить следующий код:</p>
    <pre class="code-block">
        <code class="language-javascript">
function doGet(req) {
  // Получаем активную таблицу
  var activeSheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();

  // Получаем все данные в виде 2D массива
  var data = activeSheet.getDataRange().getValues();

  // Преобразуем данные в JSON
  var jsonData = [];

  for (var i = 0; i < data.length; i++) {
    var row = {};
    for (var j = 0; j < data[i].length; j++) {
      row['col' + (j + 1)] = data[i][j];
    }
    jsonData.push(row);
  }

  // Возвращаем JSON
  return ContentService.createTextOutput(
    JSON.stringify(jsonData)
  ).setMimeType(ContentService.MimeType.JSON);
}

function doPost(e) {
  // Получаем данные из запроса
  var jsonData = JSON.parse(e.postData.contents);

  // Идентификатор вашей таблицы (замените на свой)
  var spreadsheetId = '';

  // Имя вашего листа (замените на свое)
  var sheetName = '';

  // Открываем таблицу
  var spreadsheet = SpreadsheetApp.openById(spreadsheetId);
  var sheet = spreadsheet.getSheetByName(sheetName);

  // Определяем, с какой строки начинать вставку данных
  var startRow = sheet.getLastRow() + 1;

  // Вставляем данные в таблицу
  for (var i = 0; i < jsonData.length; i++) {
    var rowData = Object.values(jsonData[i]);
    sheet.getRange(startRow + i, 1, 1, rowData.length).setValues([rowData]);
  }

  // Возвращаем успешный ответ
  return ContentService.createTextOutput(
    'Данные успешно добавлены в таблицу.'
  ).setMimeType(ContentService.MimeType.TEXT);
}</code>
    </pre>
    <p>3. <strong>Сохранить</strong> >>> <strong>Выполнить</strong> >>> <strong>Выдать разрешения</strong></p>
    <img src="../images/guide/step2.png">
    <img src="../images/guide/step3.png">
  
    <p>4. В окне "Эксперты Google не проверяли это приложение" выбрать:
        <blockquote>
        <strong>"Дополнительные настройки" >>> "Перейти на страницу "Проект без названия" (небезопасно)"</strong>
        </blockquote>
    </p>
    <img src="../images/guide/step4.png">
    <img src="../images/guide/step5.png">

    <p>5. <strong>Разрешить доступ</strong></p>

    <p>6. <strong>Начать развертывание</strong> >>> <strong>Новое развертывание</strong></p>
    <img src="../images/guide/step6.png">

    <p>7. Выберите тип - <strong>Веб-приложение</strong></p>

    <p>8. Конфигурация >>> <strong>"У кого есть доступ"</strong> поставить "<strong>все</strong>"</p>
    <img src="../images/guide/step7.png">

    <p>9. <strong>Начать развертывание</strong></p>

    <p>10. <strong>Опять предоставить разрешения</strong></p>

    <p>11. <strong>Скопировать ссылку</strong></p>
    <img src="../images/guide/step8.png">

    
    <button id="cancelBtn" class="listFormBtn">Cancel</button>
</body>
</html>